<!doctype html>
<html class="no-js" lang="en-US">


<!-- Mirrored from htmldemo.net/jantrik/jantrik/account.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jul 2024 04:21:11 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Account || Jantrik Bootstrap5 Template for Tools, Equipment Store</title>
    <meta name="description" content="Default Description">
    <meta name="keywords" content="E-commerce" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <!-- place favicon.ico in the root directory -->
   <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='img/icon/favicon.png') }}">

   <!-- Google Font css -->
   <link href="http://fonts.googleapis.com/css?family=Lily+Script+One" rel="stylesheet"> 

 <!-- mobile menu css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/meanmenu.min.css') }}">
 <!-- animate css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/animate.css') }}">
 <!-- nivo slider css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/nivo-slider.css') }}">
 <!-- owl carousel css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/owl.carousel.min.css') }}">
 <!-- slick css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/slick.css') }}">
 <!-- price slider css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/jquery-ui.min.css') }}">
 <!-- fontawesome css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}">
 <!-- fancybox css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.fancybox.css') }}">
 <!-- bootstrap css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
 <!-- default css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/default.css') }}">
 <!-- style css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
 <!-- responsive css -->
 <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">

 <!-- modernizr js -->
 <script src="{{ url_for('static', filename='js/vendor/modernizr-2.8.3.min.js') }}"></script>
 
    <style>
        .user-account-dropdown {
            position: relative;
        }

        .user-account-dropdown .user-toggle {
            color: #2874f0;
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            padding: 8px 12px;
            background-color: #fff;
            border-radius: 2px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .user-account-dropdown .user-toggle:hover {
            background-color: #f0f0f0;
        }

        .user-account-dropdown .user-toggle i {
            margin-right: 5px;
        }

        .user-account-dropdown .ht-dropdown.user-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 4px;
            display: none;
            z-index: 1000;
            min-width: 200px;
            padding: 5px 0;
        }

        .user-account-dropdown:hover .ht-dropdown.user-menu {
            display: block;
        }

        .user-account-dropdown .ht-dropdown.user-menu li {
            list-style: none;
        }

        .user-account-dropdown .ht-dropdown.user-menu a {
            display: block;
            padding: 10px 20px;
            color: #333;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .user-account-dropdown .ht-dropdown.user-menu a:hover {
            background-color: #f5f5f5;
            color: #2874f0;
        }

        .user-account-dropdown .ht-dropdown.user-menu i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .user-account-dropdown .ht-dropdown.user-menu .divider {
            height: 1px;
            background-color: #e0e0e0;
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <!--[if lt IE 8]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <!-- Wrapper Start -->
    <div class="wrapper">
        <!-- Header Area Start -->
        <header>
            <!-- Header Top Start -->
            
            <!-- Header Top End -->
            <!-- Header Bottom Start -->
            <div class="header-bottom header-sticky">
                <div class="container">
                    <div class="row justify-content-between">
                        <!--  logo Start-->
                        <div class="col-auto">
                            <div class="logo">
                                <a href="/index"><img src="{{ url_for('static', filename='img/logo/logo.png') }}"></a>
                            </div>                          
                        </div>
                       <!--  logo End -->

                        <!--  Desktop Memu Start -->
                        
                        <!--  Desktop Memu End -->
                        
                        <!--  Cartt Box  Start -->
                        <div class="col-auto">
                            <div class="cart-box text-end">
                                <ul>
                                    <li class="user-account-dropdown">
                                        <a href="#" class="user-toggle">
                                            <i class="fa fa-user-circle"></i> Hello, {{ user_info.name }} <i class="fa fa-angle-down"></i>
                                        </a>
                                        <ul class="ht-dropdown user-menu">
                                            <li><a href="/account"><i class="fa fa-user"></i> My Account</a></li>
                                            <li><a href="/wishlist"><i class="fa fa-heart"></i> Wishlist</a></li>
                                            <li class="divider"></li>
                                            <li><a href="/logout"><i class="fa fa-sign-out"></i> Logout</a></li>
                                        </ul>
                                    </li>                                    
                                    <li><a href="/wishlist"><i class="fa fa-heart-o"></i></a></li>
                                    <li>
                                        <a href="/cart"><i class="fa fa-shopping-basket"></i><span class="cart-counter">{{ cart_count }}</span></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!--  Cartt Box  End-->
                       
                        <!-- Mobile Menu  End -->                        
                    </div>
                    <!-- Row End -->
                </div>
                <!-- Container End -->
            </div>
            <!-- Header Bottom End -->
        </header>
        <!-- Header Area End -->
        <!-- Breadcrumb Start -->
        <div class="breadcrumb-area ptb-60 ptb-sm-30">
            <div class="container">
                <div class="breadcrumb">
                    <ul>
                        <li><a href="/index">Home</a></li>
                        <li class="active"><a href="/account">Account</a></li>
                    </ul>
                </div>
            </div>
            <!-- Container End -->
        </div>
        <!-- Breadcrumb End -->
        <!-- My Account Page Start Here -->
        <div class="my-account white-bg pb-60">
            <div class="container">
                <div class="account-dashboard">
                   
                   <div class="row">
                    <div class="col-lg-2">
                        <!-- Nav tabs -->
                        <ul class="nav flex-column dashboard-list" role="tablist">
                            <li><a class="active" data-bs-toggle="tab" href="#account-details">Account details</a></li>
                            <li><a data-bs-toggle="tab" href="#orders">Orders</a></li>
                            
                            
                            <li><a data-bs-toggle="tab" href='#edit-account-details'>Edit Account details</a></li>
                            <li><a href="/logout">logout</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-10">
                        <!-- Tab panes -->
                        <div class="tab-content dashboard-content mt-all-40">
                            <div id="account-details" class="tab-pane active">
                                <h3>Account details </h3>
                                <div class="register-form login-form clearfix">
                                    <form action="#">
                                        <div class="form-group row">
                                            <label for="f-name" class="col-lg-3 col-md-4 col-form-label">Name</label>
                                            <div class="col-lg-6 col-md-8">
                                                <label>{{ user_info.name }}</label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="l-name" class="col-lg-3 col-md-4 col-form-label">Address</label>
                                            <div class="col-lg-6 col-md-8">
                                                <label>{{ user_info.district }} </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="email" class="col-lg-3 col-md-4 col-form-label">Email address</label>
                                            <div class="col-lg-6 col-md-8">
                                                <label>{{ user_info.email }} </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="inputpassword" class="col-lg-3 col-md-4 col-form-label">Phone No</label>
                                            <div class="col-lg-6 col-md-8">
                                                <label>{{ user_info.phone }} </label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div id="orders" class="tab-pane fade">
                                <h3>Orders</h3>
                                <div class="order-history-container">
                                    <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                                        <table class="table">
                                            <tbody>
                                                {% for order in orders %}
                                                    <tr>
                                                        <td colspan="5">
                                                            <strong>Order ID: {{ order.get('order_id', 'N/A') }}</strong><br>
                                                            Total Price: ₹{{ "%.2f"|format(order.get('order_total', 0)) }}<br>
                                                            Order Date: {{ order.get('created_at', 'N/A') }}
                                                        </td>
                                                    </tr>
                                                    {% for item in order.get('items', []) %}
                                                    <tr>
                                                        <td>
                                                            <img src="{{ item.get('image_url', url_for('static', filename='img/default-product.jpg')) }}" 
                                                                 alt="{{ item.get('product_name', 'Product') }}" width="50" height="50">
                                                        </td>
                                                        <td>
                                                            <strong>{{ item.get('product_name', 'Unknown Product') }}</strong><br>
                                                            {% if item.get('color') %}Color: {{ item.get('color') }}{% endif %}
                                                            {% if item.get('size') %}Size: {{ item.get('size') }}{% endif %}
                                                        </td>
                                                        <td>₹{{ "%.2f"|format(item.get('item_total', 0)) }}</td>
                                                        <td>
                                                            {% if order.get('status') == 'cancelled' %}
                                                                <span class="badge bg-danger">Cancelled</span><br>
                                                                <small>Cancelled on: {{ order.get('cancelled_at', 'N/A').split('T')[0] if order.get('cancelled_at') else 'N/A' }}</small>
                                                            {% elif order.get('returns', {}).get('status') == 'returned' %}
                                                                <span class="badge bg-success">Returned</span><br>
                                                                <small>Returned on: {{ order.get('returns', {}).get('completed_at', 'N/A').split('T')[0] if order.get('returns', {}).get('completed_at') else 'N/A' }}</small>
                                                            {% elif order.get('returns', {}).get('status') == 'return_initiated' %}
                                                                <span class="badge bg-warning text-dark">Return Initiated</span><br>
                                                                <small>Initiated on: {{ order.get('returns', {}).get('initiated_at', 'N/A').split('T')[0] if order.get('returns', {}).get('initiated_at') else 'N/A' }}</small>
                                                            {% else %}
                                                                {% set earliest_rent_from = order.get('items', [])|map(attribute='rent_from')|reject('none')|first %}
                                                                <span class="badge bg-primary">Active</span><br>
                                                                <small>Rental Start: {{ earliest_rent_from.split('T')[0] if earliest_rent_from else 'N/A' }}</small>
                                                            {% endif %}
                                                        </td>
                                                    </tr>
                                                    {% endfor %}
                                                    <tr>
                                                        <td colspan="5">
                                                            <div class="d-flex flex-column align-items-start">
                                                                <div class="btn-group-vertical w-100 mb-2" role="group">
                                                                    <button class="btn btn-outline-primary btn-sm view-order-details" data-order-id="{{ order.get('order_id', '') }}">
                                                                        <i class="fa fa-eye"></i> View Details
                                                                    </button>
                                                                    <a href="{{ url_for('download_order_pdf', order_id=order.get('order_id', '')) }}" class="btn btn-outline-secondary btn-sm" target="_blank">
                                                                        <i class="fa fa-download"></i> Download Invoice
                                                                    </a>
                                                                </div>
                                                                
                                                                {% if order.get('status') != 'cancelled' and order.get('returns', {}).get('status') != 'returned' %}
                                                                    <div class="btn-group w-100" role="group">
                                                                        <button class="btn btn-outline-warning btn-sm return-item" 
                                                                            id="return-button-{{ order.get('order_id', '') }}"
                                                                            data-order-id="{{ order.get('order_id', '') }}"
                                                                            data-product-id="{{ order.get('items', [])[0].get('product_id', '') }}"
                                                                            data-return-status="{{ order.get('returns', {}).get('status', 'not_initiated') }}"
                                                                            {% if order.get('returns', {}).get('status') in ['return_initiated', 'returned'] %}disabled{% endif %}
                                                                            style="border-color: #ffc107; color: #ffc107; background-color: transparent;">
                                                                            <i class="fa fa-undo"></i> Return
                                                                        </button>
                                                                        
                                                                        <button class="btn btn-sm cancel-order btn-outline-danger"
                                                                            id="cancel-button-{{ order.get('order_id', '') }}"
                                                                            data-order-id="{{ order.get('order_id', '') }}"
                                                                            data-order-time="{{ order.get('created_at', '') }}">
                                                                            <i class="fa fa-times"></i> Cancel Order
                                                                        </button>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="5"><hr></td>
                                                    </tr>
                                                {% else %}
                                                <tr>
                                                    <td colspan="5">No orders found.</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                          
                            <div id="edit-account-details" class="tab-pane fade">
                                <h3>Edit Account details </h3>
                                <div class="register-form login-form clearfix">
                                    <form action="{{ url_for('update_account') }}" method="POST" onsubmit="return validateForm()">
                                        <div class="form-group row">
                                            <label for="f-name" class="col-lg-3 col-md-4 col-form-label">Name</label>
                                            <div class="col-lg-6 col-md-8">
                                                <input type="text" class="form-control" id="f-name" name="name" value="{{ user_info.name }}" required oninput="validateName()">
                                                <div id="nameError" style="color: red;"></div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="l-name" class="col-lg-3 col-md-4 col-form-label">Address</label>
                                            <div class="col-lg-6 col-md-8">
                                                <input type="text" class="form-control" id="l-name" name="district" value="{{ user_info.district }}" required oninput="validateDistrict()">
                                                <div id="districtError" style="color: red;"></div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="phone" class="col-lg-3 col-md-4 col-form-label">Phone No</label>
                                            <div class="col-lg-6 col-md-8">
                                                <input type="tel" class="form-control" id="phone" name="phone" value="{{ user_info.phone }}" required oninput="validatePhone()">
                                                <div id="phoneError" style="color: red;"></div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-lg-6 col-md-8">
                                                <button type="submit" class="btn btn-primary">Update</button>
                                            </div>
                                        </div>
                                    </form>
                
                                    {% with messages = get_flashed_messages(with_categories=true) %}
                                    {% if messages %}
                                        {% for category, message in messages %}
                                            <div class="alert alert-{{ category }}">
                                                {{ message }}
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                    {% endwith %}
                
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
    function validateName() {
        const nameInput = document.getElementById('f-name');
        // Replace any character that is not a letter or space with an empty string
        nameInput.value = nameInput.value.replace(/[^A-Za-z\s]/g, '');

        // Display error if any invalid character is entered
        const regex = /^[A-Za-z\s]+$/;
        if (!regex.test(nameInput.value)) {
            document.getElementById('nameError').innerText = 'Name can only contain letters and spaces.';
            return false;
        } else {
            document.getElementById('nameError').innerText = '';
            return true;
        }
    }

    function validateDistrict() {
        const districtInput = document.getElementById('l-name');
        // Replace any character that is not a letter or space with an empty string
        districtInput.value = districtInput.value.replace(/[^A-Za-z\s]/g, '');

        // Display error if any invalid character is entered
        const regex = /^[A-Za-z\s]+$/;
        if (!regex.test(districtInput.value) || districtInput.value.trim() === '') {
            document.getElementById('districtError').innerText = 'Address can only contain letters and spaces.';
            return false;
        } else {
            document.getElementById('districtError').innerText = '';
            return true;
        }
    }

    function validatePhone() {
        const phoneInput = document.getElementById('phone');
        // Replace any character that is not a digit with an empty string
        phoneInput.value = phoneInput.value.replace(/[^0-9]/g, '');

        // Display error if any invalid character is entered
        const regex = /^[0-9]{10}$/;
        if (!regex.test(phoneInput.value)) {
            document.getElementById('phoneError').innerText = 'Phone number must be 10 digits.';
            return false;
        } else {
            document.getElementById('phoneError').innerText = '';
            return true;
        }
    }
</script>
                    
                </div>
            </div>
        </div>
        <!-- My Account Page End Here -->
        <!-- Brand Logo Start -->
        <div class="brand-area pb-60">
            <div class="container">
                <!-- Brand Banner Start -->
                <div class="brand-banner owl-carousel">
                    <div class="single-brand">
                        <a href="#"><img class="img" src="{{ url_for('static', filename='img/brand/1.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/2.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/3.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/4.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/5.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img class="img" src="{{ url_for('static', filename='img/brand/1.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/2.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/3.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/4.png') }}" alt="brand-image"></a>
                    </div>
                    <div class="single-brand">
                        <a href="#"><img src="{{ url_for('static', filename='img/brand/5.png') }}" alt="brand-image"></a>
                    </div>
                </div>
                <!-- Brand Banner End -->                
            </div>
            
        </div>
        <!-- Brand Logo End -->

        <footer class="off-white-bg">
            <!-- Footer Top Start -->
            <div class="footer-top pt-50 pb-60">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-lg-6 mr-auto ml-auto">
                            <div class="newsletter text-center">
                                <div class="main-news-desc">
                                     <div class="news-desc">
                                         <h3>Sign Up For Newsletters</h3>
                                         <p>Get e-mail updates about our latest shop and special offers.</p>
                                     </div>
                                </div>
                                <div class="newsletter-box">
                                    <form action="#">
                                        <input class="subscribe" placeholder="Enter your email address" name="email" id="subscribe" type="text">
                                        <button type="submit" class="submit">subscribe</button>
                                    </form>
                                </div>
                             </div>                            
                        </div>
                    </div>                    
                    <div class="row">
                        <!-- Single Footer Start -->
                        <div class="col-lg-4  col-md-7 col-sm-6">
                            <div class="single-footer">
                                <h3>Contact us</h3>
                                <div class="footer-content">
                                    <div class="loc-address">
                                        <span><i class="fa fa-map-marker"></i>Your address goes here.</span>
                                        <span><i class="fa fa-envelope-o"></i>Mail Us: demo@example.com</span>
                                        <span><i class="fa fa-phone"></i>Phone: 0123456789</span>
                                    </div>
                                    <div class="payment-mth"><a href="#"><img class="img" src="img/footer/1.png" alt="payment-image"></a></div>
                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Start -->
                        <!-- Single Footer Start -->
                        <div class="col-lg-2  col-md-5 col-sm-6 footer-full">
                            <div class="single-footer">
                                <h3 class="footer-title">Information</h3>
                                <div class="footer-content">
                                    <ul class="footer-list">
                                        <li><a href="#">Site Map</a></li>
                                        <li><a href="#">Specials</a></li>
                                        <li><a href="#">Jobs</a></li>
                                        <li><a href="#">Delivery Information</a></li>
                                        <li><a href="#">Order History</a></li>
                                        <li><a href="#">Privacy Policy</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Start -->
                        <!-- Single Footer Start -->
                        <div class="col-lg-2  col-md-4 col-md-4 col-sm-6 footer-full">
                            <div class="single-footer">
                                <h3 class="footer-title">My Account</h3>
                                <div class="footer-content">
                                    <ul class="footer-list">
                                        <li><a href="account.html">My account</a></li>
                                        <li><a href="#">Checkout</a></li>
                                        <li><a href="#">Login</a></li>
                                        <li><a href="#">address</a></li>
                                        <li><a href="#">Order status</a></li>
                                        <li><a href="#">Site Map</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Start -->
                        <!-- Single Footer Start -->
                        <div class="col-lg-2 col-md-4 col-sm-6 footer-full">
                            <div class="single-footer">
                                <h3 class="footer-title">customer service</h3>
                                <div class="footer-content">
                                    <ul class="footer-list">
                                        <li><a href="account.html">My account</a></li>
                                        <li><a href="#">New</a></li>
                                        <li><a href="#">Gift Cards</a></li>
                                        <li><a href="#">Return Policy</a></li>
                                        <li><a href="#">Your Orders</a></li>
                                        <li><a href="#">Subway</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Start -->
                        <!-- Single Footer Start -->
                        <div class="col-lg-2 col-md-4 col-sm-6 footer-full">
                            <div class="single-footer">
                                <h3 class="footer-title">Let Us Help You</h3>
                                <div class="footer-content">
                                    <ul class="footer-list">
                                        <li><a href="#">Your Account</a></li>
                                        <li><a href="#">Your Orders</a></li>
                                        <li><a href="#">Shipping</a></li>
                                        <li><a href="#">Amazon Prime</a></li>
                                        <li><a href="#">Replacements</a></li>
                                        <li><a href="#">Manage </a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Start -->
                    </div>
                    <!-- Row End -->
                </div>
                <!-- Container End -->
            </div>
            <!-- Footer Top End -->
            <!-- Footer Bottom Start -->
            <div class="footer-bottom off-white-bg2">
                <div class="container">
                    <div class="footer-bottom-content">
                        
                        <div class="footer-social-content">
                            <ul class="social-content-list">
                                <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                <li><a href="#"><i class="fa fa-wifi"></i></a></li>
                                <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                                <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                <li><a href="#"><i class="fa fa-youtube"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Container End -->
            </div>
            <!-- Footer Bottom End -->
        </footer>
        <!-- Footer End -->
    </div>
    <!-- Wrapper End -->
    <!-- jquery 3.12.4 -->
    <script src="{{ url_for('static', filename='js/vendor/jquery-1.12.4.min.js') }}"></script>
<!-- mobile menu js  -->
<script src="{{ url_for('static', filename='js/jquery.meanmenu.min.js') }}"></script>
<!-- scroll-up js -->
<script src="{{ url_for('static', filename='js/jquery.scrollUp.js') }}"></script>
<!-- owl-carousel js -->
<script src="{{ url_for('static', filename='js/owl.carousel.min.js') }}"></script>
<!-- slick js -->
<script src="{{ url_for('static', filename='js/slick.min.js') }}"></script>
<!-- wow js -->
<script src="{{ url_for('static', filename='js/wow.min.js') }}"></script>
<!-- price slider js -->
<script src="{{ url_for('static', filename='js/jquery-ui.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.countdown.min.js') }}"></script>
<!-- nivo slider js -->
<script src="{{ url_for('static', filename='js/jquery.nivo.slider.js') }}"></script>
<!-- fancybox js -->
<script src="{{ url_for('static', filename='js/jquery.fancybox.min.js') }}"></script>
<!-- bootstrap -->
<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
<!-- plugins -->
<script src="{{ url_for('static', filename='js/plugins.js') }}"></script>
<!-- main js -->
<script src="{{ url_for('static', filename='js/main.js') }}"></script>

<link rel="stylesheet" href="http://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- Modal for Order Details -->
<div class="modal fade" id="orderDetailsModal" tabindex="-1" role="dialog" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="orderDetailsModalLabel">Order Details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="orderDetailsContent">
                <!-- Order details will be inserted here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Add this just before the closing </body> tag -->
<!-- Modal for Return Process -->
<div class="modal fade" id="returnModal" tabindex="-1" role="dialog" aria-labelledby="returnModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="returnModalLabel">Return Product</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="returnModalBody">
                <!-- Content will be dynamically inserted here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="confirmReturn">Confirm Return</button>
            </div>
        </div>
    </div>
</div>

<div class="position-fixed bottom-0 right-0 p-3" style="z-index: 5; right: 0; bottom: 0;">
  <div id="liveToast" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true" data-delay="5000">
    <div class="toast-header">
      <strong class="mr-auto" id="toastTitle">Notification</strong>
      <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="toast-body" id="toastMessage">
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const returnButtons = document.querySelectorAll('.return-item');
    const returnModal = document.getElementById('returnModal');
    const returnModalBody = document.getElementById('returnModalBody');
    const confirmReturnButton = document.getElementById('confirmReturn');

    function createToastContainer() {
        const toastContainer = document.createElement('div');
        toastContainer.className = 'position-fixed bottom-0 right-0 p-3';
        toastContainer.style.zIndex = '5';
        toastContainer.style.right = '0';
        toastContainer.style.bottom = '0';
        toastContainer.innerHTML = `
            <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="5000">
                <div class="toast-header">
                    <strong class="mr-auto" id="toastTitle">Notification</strong>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body" id="toastMessage"></div>
            </div>
        `;
        document.body.appendChild(toastContainer);
    }

    function showToast(title, message, isError = false) {
        let toast = document.getElementById('liveToast');
        if (!toast) {
            createToastContainer();
            toast = document.getElementById('liveToast');
        }
        const toastTitle = document.getElementById('toastTitle');
        const toastMessage = document.getElementById('toastMessage');
        
        if (toastTitle) toastTitle.textContent = title;
        if (toastMessage) toastMessage.textContent = message;
        
        toast.classList.toggle('bg-danger', isError);
        toast.classList.toggle('text-white', isError);
        
        // Initialize the toast with options
        $(toast).toast({
            delay: 5000, // 5 seconds
            autohide: true
        });
        
        // Show the toast
        $(toast).toast('show');
    }

    function calculateRemainingDays(rentToDate) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const rentTo = new Date(rentToDate);
        rentTo.setHours(0, 0, 0, 0);
        const timeDiff = rentTo.getTime() - today.getTime();
        return Math.ceil(timeDiff / (1000 * 3600 * 24));
    }

    returnButtons.forEach(button => {
        button.addEventListener('click', function() {
            const orderId = this.getAttribute('data-order-id');
            
            console.log('Return button clicked:', orderId);

            fetch(`/order/${orderId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Fetched data:', data);
                    if (data.success && data.order && data.order.items && data.order.items.length > 0) {
                        const order = data.order;
                        const item = order.items[0];
                        console.log('Item found:', item);
                        
                        if (item && item.rent_to) {
                            const rentToDate = new Date(item.rent_to);
                            const returnDate = new Date(rentToDate);
                            const pickupDate = new Date(rentToDate);
                            pickupDate.setDate(pickupDate.getDate() + 1);

                            const remainingDays = calculateRemainingDays(rentToDate);
                            const daysText = remainingDays > 0 ? `${remainingDays} days remaining` : 'Return overdue';

                            returnModalBody.innerHTML = `
                                <p><strong>Product:</strong> ${item.product_name}</p>
                                <p><strong>Return Date:</strong> ${returnDate.toLocaleDateString()}</p>
                                <p><strong>Pickup Date:</strong> ${pickupDate.toLocaleDateString()}</p>
                                <p><strong>Countdown:</strong> <span class="text-${remainingDays > 0 ? 'success' : 'danger'}">${daysText}</span></p>
                                <p>Please ensure the product is ready for pickup on the specified date.</p>
                            `;

                            confirmReturnButton.style.display = 'block';
                            $(returnModal).modal('show');
                        } else {
                            showToast('Error', 'Unable to process return due to missing rental information. Please contact support.', true);
                        }
                    } else {
                        showToast('Error', 'Could not find order details. Please contact support.', true);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showToast('Error', 'An error occurred while processing your request. Please try again later.', true);
                });
        });
    });

    confirmReturnButton.addEventListener('click', function() {
        // Here you would implement the logic to process the return
        // For now, we'll just close the modal and show a success message
        $(returnModal).modal('hide');
        showToast('Success', 'Return process initiated. You will be contacted for pickup.');
    });

    // Close modal when clicking on close button or outside the modal
    returnModal.addEventListener('click', function(event) {
        if (event.target === returnModal || event.target.classList.contains('close')) {
            $(returnModal).modal('hide');
        }
    });
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const cancelButtons = document.querySelectorAll('.cancel-order');

    cancelButtons.forEach(button => {
        const orderId = button.getAttribute('data-order-id');
        const orderTime = new Date(button.getAttribute('data-order-time'));
        const cancelWindowMs = 10 * 60 * 1000; // 10 minutes in milliseconds
        
        // Hide the corresponding return button
        const returnButton = document.getElementById(`return-button-${orderId}`);
        if (returnButton) {
            returnButton.style.display = 'none';
        }

        updateCancelButton(button, orderTime, cancelWindowMs, returnButton);

        button.addEventListener('click', function() {
            if (!this.disabled) {
                if (confirm('Are you sure you want to cancel this order?')) {
                    cancelOrder(orderId, this, returnButton);
                }
            }
        });
    });

    function updateCancelButton(button, orderTime, cancelWindowMs, returnButton) {
        const now = new Date();
        const timeSinceOrder = now - orderTime;
        const timeLeftMs = cancelWindowMs - timeSinceOrder;

        if (timeLeftMs <= 0) {
            button.style.display = 'none';
            if (returnButton) {
                returnButton.style.display = 'inline-block'; // Show return button when cancel window closes
            }
            return;
        }

        const minutes = Math.floor(timeLeftMs / 60000);
        const seconds = Math.floor((timeLeftMs % 60000) / 1000);

        button.textContent = `Cancel Order (${minutes}:${seconds.toString().padStart(2, '0')})`;

        setTimeout(() => updateCancelButton(button, orderTime, cancelWindowMs, returnButton), 1000);
    }

    function cancelOrder(orderId, button, returnButton) {
        fetch('/cancel-order', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ order_id: orderId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Order cancelled successfully');
                button.textContent = 'Cancelled';
                button.classList.remove('btn-danger');
                button.classList.add('btn-secondary');
                button.disabled = true;

                // Keep the return button hidden after cancellation
                if (returnButton) {
                    returnButton.style.display = 'none';
                }
            } else {
                alert('Failed to cancel order: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while cancelling the order');
        });
    }
});
</script>

</body>


<!-- Mirrored from htmldemo.net/jantrik/jantrik/account.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jul 2024 04:21:12 GMT -->
</html>